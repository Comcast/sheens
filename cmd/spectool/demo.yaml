name: toolcompdemo
doc: |-
  A demo machine that's almost all generated by tool invocation.
nodes:
  start:
    branching:
      type: message
      branches:
      - pattern: '{"get":"lunch"}'
        target: lunch_start
  timedout:
    action:
      interpreter: goja
      source: |-
        var bs = _.bindings.Remove('timer');
        bs.cleanupMessages = [];
        bs;
    doc: |-
      Retry forever!  Target variables are dangerous.
      Don't have to use them, but they make for fewer nodes.
    branching:
      branches:
      - target: '@from'
  listenForEnable:
    branching:
      type: message
      branches:
      - pattern: '{"ctl":"enable"}'
        target: start
  done:
    branching:
      branches:
      - target: start
  demo:
    macro: turnOn
    deviceid: light42
    to: there
